
function redo() {
  if (redoHistory.length > 0) {
    let nextState = redoHistory.pop();
    history.push(nextState); 

    // Clear and redraw ALL layers
    for (let i = 1; i <= layerCount; i++) {
      contexts[i].clearRect(0, 0, layers[i].width, layers[i].height);
      contexts[i].putImageData(nextState[i - 1], 0, 0);
    }
  }
}
function undo() {
  if (history.length > 1) {
    redoHistory.push(history.pop());
    currentCtx.clearRect(0, 0, layer1.width, layer1.height);
    if (history.length === 0 && clearedCanvasState) {
      currentCtx.putImageData(clearedCanvasState, 0, 0);
    } else {
      redrawCanvas();
    }
  }
}

function redo() {
  if (redoHistory.length > 0) {
    history.push(redoHistory.pop());
    currentCtx.clearRect(0, 0, layer1.width, layer1.height);
    redrawCanvas();
  }
}